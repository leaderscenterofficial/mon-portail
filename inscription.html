<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Inscription Leaders Center</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    label { display: block; margin-top: 10px; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    .mois { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>Formulaire d'inscription</h2>
  <form id="inscriptionForm">
    <label>Nom : <input type="text" name="nom" required /></label>
    <label>Prénom : <input type="text" name="prenom" required /></label>
    <label>Date de naissance : <input type="date" name="dob" id="dob" required /></label>
    <label>Niveau scolaire :
      <select name="niveau" required>
        <option value="">Sélectionner</option>
        <option value="Primaire">Primaire</option>
        <option value="Collège">Collège</option>
        <option value="Lycée">Lycée</option>
      </select>
    </label>
    <label>Matières :
      <select multiple name="matieres" id="matieres">
        <option value="Maths">Maths</option>
        <option value="Physique">Physique</option>
        <option value="Français">Français</option>
        <option value="Anglais">Anglais</option>
      </select>
    </label>

    <label>Prix initial : <input type="number" id="prix_initial" required /></label>
    <label>Remise (%) : <input type="number" id="remise" value="0" /></label>
    <label>Prix final : <input type="number" id="prix_final" readonly /></label>

    <div class="mois">
      <label>Janvier <input type="text" name="Janvier" /></label>
      <label>Février <input type="text" name="Février" /></label>
      <label>Mars <input type="text" name="Mars" /></label>
      <label>Avril <input type="text" name="Avril" /></label>
      <label>Mai <input type="text" name="Mai" /></label>
      <label>Juin <input type="text" name="Juin" /></label>
      <label>Juillet <input type="text" name="Juillet" /></label>
      <label>Août <input type="text" name="Août" /></label>
      <label>Septembre <input type="text" name="Septembre" /></label>
      <label>Octobre <input type="text" name="Octobre" /></label>
      <label>Novembre <input type="text" name="Novembre" /></label>
      <label>Décembre <input type="text" name="Décembre" /></label>
    </div>

    <button type="submit">Envoyer</button>
  </form>

  <script>
    const form = document.getElementById("inscriptionForm");
    const prixInitialInput = document.getElementById("prix_initial");
    const remiseInput = document.getElementById("remise");
    const prixFinalInput = document.getElementById("prix_final");

    function calculerPrixFinal() {
      const prixInitial = parseFloat(prixInitialInput.value) || 0;
      const remise = parseFloat(remiseInput.value) || 0;
      const prixFinal = prixInitial - (prixInitial * remise / 100);
      prixFinalInput.value = prixFinal.toFixed(2);
    }

    prixInitialInput.addEventListener("input", calculerPrixFinal);
    remiseInput.addEventListener("input", calculerPrixFinal);

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(form);

      // Ajout manuel des champs calculés
      formData.append("prix_initial", prixInitialInput.value);
      formData.append("remise", remiseInput.value);
      formData.append("prix_final", prixFinalInput.value);

      // Matières concaténées
      const matieres = Array.from(document.getElementById("matieres").selectedOptions)
                            .map(opt => opt.value).join(", ");
      formData.append("matieres_concat", matieres);

      try {
        const response = await fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec", {
          method: "POST",
          body: formData
        });

        const result = await response.text();
        alert(result);
        form.reset();
        prixFinalInput.value = "";
      } catch (error) {
        alert("Erreur : " + error.message);
      }
    });
  </script>
</body>
</html>
